---
export_on_save:
 html: true
---

# ch2. 计算机网络和因特网

[toc]

- 网络应用是计算机网络存在的理由，因特网应用包括
  - 基于文本的应用
    - 文本电子邮件
    - 远程访问计算机
    - 文件传输
    - 新闻组
  - 万维网
    - Web冲浪
    - 搜索
    - 电子商务
  - 新的应用
    - IP电话（VoIP
    - IP视频会议（如Skype
    - 用户生成 的视频分布（如YouTube
    - 点播电影（如Netflix）
    - 多方在线游戏
    - 新一代的社交网络
      - Facebook
      - Instagram
      - Twitter
      - 微信

## 2.1 应用层协议

- 研发网络应用程序的核心是写出能够运行在不同的端系统和通过网络彼此通信的程序
  - 由于网络的分层设计，因此开发网络应用程序时，不需要写在网络核心设备如路由器或链路层交换机上运行的软件
  - 分层设计，即将应用软件限制在端系统的方法，促进了大量的网络应用程序的迅速研发和部署
  - ![网络应用的通信](images/2020-07-17-12-32-33.png)

### 2.1.1 网络应用程序体系结构

- 从应用程序研发者的角度看，网络体系结构是固定的，并为应用程序提供了特定的服务集合
- 应用程序体系结构（application architecture）由应用程序研发者设计, 规定了如何在各种端系统上组织该应用程序
  - 两种主流体系结构
    - 客户-服务器体系结构
      - ![客户-服务器体系结构](images/2020-07-17-12-36-08.png)
      - 特点
        - 有一个总是打开的主机称为**服务器**，它服务于来自许多其他称为**客户**的主机的请求
        - 利用客户-服务器体系结构，客户相互之间不直接通信
        - 服务器具有固定的、周知的地址，该地址称为IP地址
      - 应用程序
        - Web、 FTP、Telnet和电子邮件
      - 问题
        - 常常会出现一台单独的服务器主机跟不上它所有客户请求的情况
        - 为此，配备大量主机的**数据中心**常被用于创建强大的虚拟服务器
          - 一个数据中心能够有数十万台服务器，它们必须要供电和维护
          - 服务提供商必须支付不断出现的互联和带宽费用，以发送和接收到达/来自数据中心的数据
    - 对等（P2P）体系结构
      - ![P2P 体系结构](images/2020-07-17-12-36-52.png)
      - 特点
        - 对位于数据中心的专用服务器有最小的（或者没有）依赖
        - 应用程序在间断连接的主机对之间使用直接通信
          - 这些主机对被称为对等方
        - 这种对等方通信不必通过专门的服务器，该体系结构被称为对等方到对等方的
        - 自扩展性（self-scalability）
          - 在一个P2P文件共享应用中，尽管每个对等方都由于请求文件产生工作量
          - 但每个对等方 通过向其他对等方分发文件也为系统增加服务能力
        - P2P体系结构也是成本有效的
          - 它们通常不需要庞大的服务器基础设施和服务器带宽
      - 应用程序
        - 许多目前流行的、流量密集型应用都是P2P体系结构的
        - 文件共享（例如BitTorrent）
        - 对等方协助下载加速器（例如迅雷）
        - 因特网电话（例如Skype）

### 2.1.2 进程通信

- 在操作系统的术语中，进行通信的实际上是进程（process）而不是程序
  - 当进程运行在相同的端系统上时，它们使用进程间通信机制相互通信
    - 进程间通信的规则由端系统上的操作系统确定
  - 在两个不同端系统上的进程，通过跨越计算机网络交换报文（message）而相互通信

#### 客户和服务器进程

- 网络应用程序由成对的进程组成，这些进程通过网络相互发送报文
- 对每对通信进程，我们通常将这两个进程之一标识为客户（client）,而另一个进程标识为服务器（server）
  - 在给定的一对进程之间的通信会话场景中，发起通信（即在该会话开始时发起与其他进程的联系）的进程被标识为**客户**，在会话开始时等待联系的进程是**服务器**

#### 进程与计算机网络之间的接口

- 进程通过一个称为**套接字**（socket）的软件接口向网络发送报文和从网络接收报文
- 套接字
  - ![套接字](images/2020-07-17-12-53-10.png)
  - 套接字是同一台主机内应用层与运输层之间的接口
  - 套接字也称为应用程序和网络之间的应用程序编程接口（Application Programming Interface, API）
  - 应用程序开发者对于运输层的控制仅限于：
    - 选择运输层协议
    - 设定几个运输层参数，如最大缓存和最大报文段长度等

#### 进程寻址

- 为了标识接收进程，需要定义两种信息
  - 主机的地址
    - 主机由其IP地址（IP address）标识
  - 定义在目的主机中的接收进程的标识符
    - 目的地**端口号**（port number）用于指定运行在接收主机上的接收进程
    - 流行的应用已被分配了特定的端口号
      - Web服务器用端口号80来标识
      - 邮件服务器进程（使用SMTP 协议）用端口号25来标识

### 可供应用程序使用的运输服务

- 包括因特网在内的很多网络提供了不止一种运输层协议
  - 当开发一个应用时，必须选择一种可用的运输层协议
  - 需要根据实际的应用需求来选择恰当的服务协议

- 应用程序要求运输层协议能提供的服务大体包括四个方面：可靠数据传输、吞吐量、定时和安全性

#### 可靠数据传输

- 如果一个协议提供了确保数据交付服务，就认为提供了可靠数据传输(reliable data transfer)
  - 确保数据交付服务是指确保由应用程序的一端发送的数据正确、完全地交付给该应用程序的另一端
- 容忍丢失的应用(loss-tolerant application)
  - 当一个运输层协议不提供可靠数据传输时, 可能能被容忍丢失的应用所接受
  - 在多媒体应用中，能够承受一定量的数据丢失
    - 丢失的数据引起播放的音频/视频出现小干扰，而不是致命的损伤

#### 吞吐量

- 可用吐吞量
  - 在沿着一条网络路径上的两个进程之间的通信会话场景中，可用吞吐量就是发送进程能够向接收进程交付比特的速率
- 运输层协议能够以某种特定的速率提供确保的可用吞吐量

- 具有吞吐量要求的应用程序被称为**带宽敏感的应用**(bandwidth-sensitive application) 
  - 许多当前的多媒体应用是带宽敏感的

- **弹性应用**(elastic application)
  - 能够根据情况或多或少地利用可供使用的吞吐量
  - 电子邮件、文件传输以及 Web 传送都属于弹性应用

#### 定时

- 运输层协议也能提供定时保证
  - 如发送方注入进套接字中的每个比特到达接收方的套接字不迟于100ms
  - 对交互式实时应用程序有吸引力
    - 如因特网电话、虚拟环境、电话会议和多方游戏
    - 所有这些服务为了有效性而要求数据交付有严格的时间限制

#### 安全性

- 运输协议能够为应用程序提供一种或多种安全性服务
  - 提供数据的加密和解密功能
  - 数据完整性和端点鉴别

### 2.1.4 因特网提供的运输服务

- 因特网（更一般的是TCP/IP网络）为应用程序 提供两个运输层协议，即UDP和TCP
- 某些网络应用的相求

| 应用         | 数据丢失 | 带宽                                       | 时间敏感    |         |
|------------|------|------------------------------------------|---------|---------|
| 文件传输       | 不能丢失 | 弹性                                       | 不       |         |
| 电子邮件       | 不能丢失 | 弹性                                       | 不       | 不       |
| Web文档      | 不能丢失 | 弹性（几kbps）                                | 不       | 不       |
| 因特网电话/视频会议 | 容忍丢失 | 音频(几 kbps ~ 1 Mbps)，视频(10 kbps ~ 5 Mbps) | 是，100ms |
| 存储音频/视频    | 容忍丢失 | 同上                                       | 是，几秒    | 是.几秒    |
| 交互式游戏      | 容忍丢失 | 几 kbps ~ 10 kbps                         | 是，100ms | 是，100ms |
| 智能手机讯息     | 不能丢失 | 弹性                                       | 是和不是    | 是和不是    |

